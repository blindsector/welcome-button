<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>–¢–∞–µ–Ω –ß–∞—Ç 2.0</title>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #00b3ff, #0077ff);
    color: white;
}

h1 {
    text-align: center;
    padding: 15px;
}

.container {
    display: flex;
    gap: 20px;
    padding: 20px;
}

.panel {
    flex: 1;
    background: rgba(255,255,255,0.1);
    padding: 15px;
    border-radius: 15px;
    display: flex;
    flex-direction: column;
}

.chatlog {
    flex: 1;
    background: white;
    color: black;
    border-radius: 10px;
    padding: 10px;
    overflow-y: auto;
    margin-bottom: 10px;
    font-size: 14px;
}

textarea, select {
    width: 100%;
    border-radius: 8px;
    border: none;
    padding: 8px;
    margin-top: 5px;
    font-size: 14px;
}

button {
    margin-top: 8px;
    padding: 8px;
    border-radius: 8px;
    border: none;
    background: #ff4d4d;
    color: white;
    font-weight: bold;
    cursor: pointer;
}
button:hover { transform: scale(1.05); }

.label {
    font-weight: bold;
    margin-top: 5px;
}
</style>
</head>
<body>

<h1>üïµÔ∏è –¢–∞–µ–Ω –ß–∞—Ç –°–∏—Å—Ç–µ–º–∞ 2.0</h1>

<div class="container">

    <!-- –õ–Ø–í–û: –¢–ò –ö–™–ú –ú–ï–ù -->
    <div class="panel">
        <div class="label">–¢–∏ –ø–∏—à–µ—à –Ω–æ—Ä–º–∞–ª–Ω–æ</div>
        <div id="myChat" class="chatlog"></div>

        <textarea id="inputText" placeholder="–ù–∞–ø–∏—à–∏ —Å—ä–æ–±—â–µ–Ω–∏–µ..."></textarea>

        <div class="label">–†–µ–∂–∏–º</div>
        <select id="modeSelect">
            <option value="garaga">üêî –ì–∞—Ä–≥–∞</option>
            <option value="spy">üïµÔ∏è –®–ø–∏–æ–Ω–∏</option>
            <option value="magic">üßô –ú–∞–≥—å–æ—Å–Ω–∏–∫</option>
        </select>

        <div class="label">–°—Ö–µ–º–∞ (–ø—Ä–∞—â–∞ —Å–µ —Å–∞–º–æ –≤ –ø—ä—Ä–≤–æ—Ç–æ —Å—ä–æ–±—â–µ–Ω–∏–µ)</div>
        <textarea id="schemeBox" placeholder="#—Ä–µ–∂–∏–º: –≥–∞—Ä–≥–∞"></textarea>
    </div>

    <!-- –î–Ø–°–ù–û: –ö–û–î–ò–†–ê–ù–û –ò –†–ê–ó–ö–û–î–ò–†–ê–ù–û -->
    <div class="panel">
        <div class="label">üîí –ö–æ–¥–∏—Ä–∞–Ω —Ç–µ–∫—Å—Ç –∑–∞ –ø—Ä–∞—â–∞–Ω–µ</div>
        <div id="encodedChat" class="chatlog"></div>
        <button onclick="copyEncoded()">üìã –ö–æ–ø–∏—Ä–∞–π –ø–æ—Å–ª–µ–¥–Ω–æ—Ç–æ</button>

        <div class="label">üì© –ü–µ–π—Å—Ç–Ω–∏ –º–æ–π –æ—Ç–≥–æ–≤–æ—Ä (–∫–æ–¥–∏—Ä–∞–Ω)</div>
        <textarea id="incomingText" placeholder="–ü–µ–π—Å—Ç–Ω–∏ –∫–æ–¥–∏—Ä–∞–Ω–∏—è —Ç–µ–∫—Å—Ç –æ—Ç ChatGPT..."></textarea>

        <div class="label">üîì –†–∞–∑–∫–æ–¥–∏—Ä–∞–Ω–æ —Å—ä–æ–±—â–µ–Ω–∏–µ</div>
        <div id="decodedChat" class="chatlog"></div>
    </div>

</div>

<script>
let firstMessage = true;

const dictionaries = {
    garaga: {
        "–∑–¥—Ä–∞–≤–µ–π":"–±—Ä—è–º–æ",
        "–∫–∞–∫":"—Ç—Ä–µ–∫–æ",
        "—Å–∏":"–∑—É—Ä–Ω–∞",
        "–ø—Ä–∏—è—Ç–µ–ª":"–º—É–ª—á–∞",
        "–¥–æ–±—Ä–µ":"—à–∏–≤—Ä–∞"
    },
    spy: {
        "–∑–¥—Ä–∞–≤–µ–π":"–∞–≥–µ–Ω—Ç",
        "–∫–∞–∫":"—Å—Ç–∞—Ç—É—Å",
        "—Å–∏":"–æ–±–µ–∫—Ç",
        "–ø—Ä–∏—è—Ç–µ–ª":"—Å—ä—é–∑–Ω–∏–∫",
        "–¥–æ–±—Ä–µ":"—Å—Ç–∞–±–∏–ª–Ω–æ"
    },
    magic: {
        "–∑–¥—Ä–∞–≤–µ–π":"–∞–ª–æ—Ö–æ–º",
        "–∫–∞–∫":"–º–∞—Ä–∞–∫–∞",
        "—Å–∏":"–∑—É—Ä–µ–ª",
        "–ø—Ä–∏—è—Ç–µ–ª":"—Ñ–µ–ª–æ—Ä–∞",
        "–¥–æ–±—Ä–µ":"–≤–∏—Ä–∞–ª"
    }
};

function encodeText(text, mode) {
    let dict = dictionaries[mode];
    let words = text.toLowerCase().split(" ");
    return words.map(w => dict[w] || w).join(" ");
}

function decodeText(text) {
    let allDicts = Object.values(dictionaries);
    let words = text.toLowerCase().split(" ");
    return words.map(w => {
        for (let dict of allDicts) {
            for (let key in dict) {
                if (dict[key] === w) return key;
            }
        }
        return w;
    }).join(" ");
}

document.getElementById("inputText").addEventListener("keydown", function(e){
    if(e.key === "Enter" && !e.shiftKey){
        e.preventDefault();

        let text = this.value.trim();
        if(!text) return;

        let mode = document.getElementById("modeSelect").value;
        let encoded = encodeText(text, mode);

        if(firstMessage){
            let scheme = document.getElementById("schemeBox").value.trim();
            if(scheme) encoded = scheme + "\n" + encoded;
            firstMessage = false;
        }

        document.getElementById("myChat").innerHTML += "<div>üßë " + text + "</div>";
        document.getElementById("encodedChat").innerHTML += "<div>üîí " + encoded + "</div>";

        this.value = "";
    }
});

document.getElementById("incomingText").addEventListener("input", function(){
    let decoded = decodeText(this.value);
    document.getElementById("decodedChat").innerHTML = "<div>ü§ñ " + decoded + "</div>";
});

function copyEncoded(){
    let chat = document.getElementById("encodedChat");
    let last = chat.lastElementChild;
    if(!last) return;
    navigator.clipboard.writeText(last.innerText.replace("üîí ",""));
}
</script>

</body>
</html>
