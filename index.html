<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>–¢–∞–µ–Ω –ß–∞—Ç v3</title>
<style>
body {margin:0;font-family:Arial;background:linear-gradient(135deg,#00c6ff,#0072ff);color:white;}
.container{display:flex;gap:20px;padding:20px}
.panel{flex:1;background:rgba(255,255,255,.08);padding:15px;border-radius:15px;backdrop-filter:blur(10px);display:flex;flex-direction:column}
.chatbox{flex:1;background:white;color:black;padding:10px;border-radius:10px;overflow-y:auto;margin-bottom:10px;font-family:monospace}
textarea,select{width:100%;padding:10px;border-radius:8px;border:none;margin-bottom:10px;font-size:14px}
button{padding:10px;border-radius:8px;border:none;background:#ff4d4d;color:white;font-weight:bold;cursor:pointer;margin-bottom:5px}
button:hover{background:#ff1a1a}
</style>
</head>
<body>

<div class="container">
<div class="panel">
<h2>üß† –¢–∏ –ø–∏—à–µ—à –Ω–æ—Ä–º–∞–ª–Ω–æ</h2>
<div id="myChat" class="chatbox"></div>
<textarea id="inputText" placeholder="–ù–∞–ø–∏—à–∏ —Å—ä–æ–±—â–µ–Ω–∏–µ..."></textarea>

<select id="modeSelect">
<option value="garaga">–ì–∞—Ä–≥–∞</option>
<option value="shadow">–°—è–Ω–∫–∞</option>
<option value="hybrid">–•–∏–±—Ä–∏–¥ üî•</option>
</select>

<button onclick="sendMessage()">–ò–∑–ø—Ä–∞—Ç–∏ ‚ûú</button>
<button onclick="clearChat()">üóë –ò–∑—á–∏—Å—Ç–∏</button>
</div>

<div class="panel">
<h2>üîê –ö–æ–¥–∏—Ä–∞–Ω —Ç–µ–∫—Å—Ç</h2>
<div id="encodedChat" class="chatbox"></div>
<button onclick="copyLast()">üìã –ö–æ–ø–∏—Ä–∞–π –ø–æ—Å–ª–µ–¥–Ω–æ—Ç–æ</button>

<h2>üì• –ü–µ–π—Å—Ç–Ω–∏ –æ—Ç–≥–æ–≤–æ—Ä (–∫–æ–¥–∏—Ä–∞–Ω)</h2>
<textarea id="replyInput"></textarea>
<button onclick="decodeReply()">–†–∞–∑–∫–æ–¥–∏—Ä–∞–π ‚¨á</button>

<h2>üí¨ –†–∞–∑–∫–æ–¥–∏—Ä–∞–Ω–æ</h2>
<div id="decodedChat" class="chatbox"></div>
</div>
</div>

<script>
const noiseWords = ["–∑–æ—Ä–∫","–º—Ä–∞–∫—Å","—Ç—É–ª–±–∞","–≥—Ä–∞—Ö—Ç","—Å–µ–Ω–∫","–≤–æ—Ä–¥–µ–∫—Å"];

const bigDictionary = {
"–∑–¥—Ä–∞–≤–µ–π":"–≥–ª—É–≤–µ–∫","–∫–∞–∫":"—Ç—Ä–æ–º","—Å–∏":"–≤–∞—Ä–¥","–ø—Ä–∏—è—Ç–µ–ª":"–º—É—Ä–∫–∞",
"–ø–∞—Ä–∏":"–∂—ä–ª—Ç–∏—Ü–∏","—Ä–∞–±–æ—Ç–∞":"–º–∏—Å–∏—è","–ø–ª–∞–Ω":"—Å—Ö–µ–º–æ—Ä–∞","—Ç–∞–π–Ω–∞":"–º—ä–≥–ª–∞",
"—á–∞—Ç":"–∫—Ä–∏–ø—Ç–æ—Ä","—Å—ä–æ–±—â–µ–Ω–∏–µ":"–¥–µ–∫–ª–∞—Ä–∞","–¥–∞":"—Ç—Ä–æ–ª–∞","–Ω–µ":"–≤–∞–∫—Ä–∞",
"–æ—Ç–∏–≤–∞–º":"–ø–æ—Ç–µ–≥–ª—è–º","–∏–¥–≤–∞–º":"–ø—Ä–∏–∏–∂–¥–∞–º","—á–∞–æ":"–∑–∞–ª–µ–∑","–¥–æ–±—Ä–µ":"—Å—Ç–∞–±–∏–ª–Ω–æ",
"–±—ä—Ä–∑–æ":"—Å–≤–µ—Ç–∫–∞–≤–∏—á–Ω–æ","—á–∞–∫–∞–π":"–∑–∞–¥—Ä—ä–∂","—Ç—É–∫":"–ø–æ–∑–∏—Ü–∏—è","—Ç–∞–º":"–∑–æ–Ω–∞"
};

function randomNoise(){
return Math.random()<0.3 ? noiseWords[Math.floor(Math.random()*noiseWords.length)] : "";
}

function scramble(word){
if(word.length<4) return word;
let mid = word.slice(1,-1).split("").sort(()=>Math.random()-0.5).join("");
return word[0]+mid+word[word.length-1];
}

function encodeWord(word){
let clean = word.toLowerCase();
let base = bigDictionary[clean] || scramble(clean);
if(Math.random()<0.2) base += Math.floor(Math.random()*9);
return base;
}

function encode(text,mode){
let words = text.split(" ");
let result = [];
for(let w of words){
if(mode==="hybrid"){
result.push(encodeWord(w));
let noise = randomNoise();
if(noise) result.push(noise);
}else{
result.push(bigDictionary[w.toLowerCase()] || w);
}
}
return result.join(" ");
}

function autoDecodeWord(word){
let reversed = Object.fromEntries(Object.entries(bigDictionary).map(([k,v])=>[v,k]));
let clean = word.replace(/[0-9]/g,"");
if(reversed[clean]) return reversed[clean];
return word;
}

function decode(text){
let words = text.split(" ");
let result = words.map(w=>autoDecodeWord(w)).filter(w=>!noiseWords.includes(w));
return result.join(" ");
}

function sendMessage(){
let text=inputText.value.trim();
if(!text) return;
let mode=modeSelect.value;
let encoded=encode(text,mode);
myChat.innerHTML+="üßë: "+text+"<br>";
encodedChat.innerHTML+="üîí: "+encoded+"<br>";
inputText.value="";
saveHistory();scrollAll();
}

function decodeReply(){
let text=replyInput.value.trim();
if(!text) return;
let decoded=decode(text);
decodedChat.innerHTML+="ü§ñ: "+decoded+"<br>";
replyInput.value="";
saveHistory();scrollAll();
}

function copyLast(){
let lines=encodedChat.innerText.trim().split("\n");
navigator.clipboard.writeText(lines.pop().replace("üîí: ",""));
alert("–ö–æ–ø–∏—Ä–∞–Ω–æ");
}

function scrollAll(){
["myChat","encodedChat","decodedChat"].forEach(id=>{
let el=document.getElementById(id);el.scrollTop=el.scrollHeight;
});
}

function saveHistory(){
localStorage.setItem("myChat",myChat.innerHTML);
localStorage.setItem("encodedChat",encodedChat.innerHTML);
localStorage.setItem("decodedChat",decodedChat.innerHTML);
}

function loadHistory(){
myChat.innerHTML=localStorage.getItem("myChat")||"";
encodedChat.innerHTML=localStorage.getItem("encodedChat")||"";
decodedChat.innerHTML=localStorage.getItem("decodedChat")||"";
}

function clearChat(){
if(confirm("–°–∏–≥—É—Ä–µ–Ω –ª–∏ —Å–∏?")){
localStorage.clear();location.reload();
}
}

loadHistory();
</script>
</body>
</html>
