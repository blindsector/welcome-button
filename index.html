<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>–¢–∞–µ–Ω –ß–∞—Ç v3.5</title>
<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#00b3ff,#0077ff);
  color:white;
}

.container{
  display:flex;
  gap:20px;
  padding:20px;
}

.box{
  flex:1;
  background:rgba(255,255,255,0.08);
  padding:15px;
  border-radius:15px;
  backdrop-filter: blur(8px);
}

h2{margin-top:0}

textarea, input{
  width:100%;
  border-radius:10px;
  border:none;
  padding:10px;
  margin-top:10px;
  font-size:15px;
}

button{
  margin-top:10px;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#ff4d4d;
  color:white;
  font-size:16px;
  cursor:pointer;
}

.chatHistory{
  background:white;
  color:black;
  height:120px;
  overflow:auto;
  padding:10px;
  border-radius:10px;
  margin-top:10px;
}
</style>
</head>
<body>

<div class="container">

  <div class="box">
    <h2>üß† –¢–∏ –ø–∏—à–µ—à –Ω–æ—Ä–º–∞–ª–Ω–æ</h2>
    <div id="chatBox" class="chatHistory"></div>
    <textarea id="normalInput" placeholder="–ù–∞–ø–∏—à–∏ —Å—ä–æ–±—â–µ–Ω–∏–µ..."></textarea>
    <input type="text" id="secretKey" placeholder="–¢–∞–µ–Ω –∫–ª—é—á (–ø–æ –∂–µ–ª–∞–Ω–∏–µ)">
    <button onclick="encodeMessage()">–ò–∑–ø—Ä–∞—Ç–∏ ‚ûú</button>
  </div>

  <div class="box">
    <h2>üîê –ö–æ–¥–∏—Ä–∞–Ω–æ</h2>
    <div id="encodedBox" class="chatHistory"></div>

    <h2>üì• –ü–µ–π—Å—Ç–Ω–∏ –æ—Ç–≥–æ–≤–æ—Ä (–∫–æ–¥–∏—Ä–∞–Ω)</h2>
    <textarea id="replyInput" placeholder="–ü–µ–π—Å—Ç–Ω–∏ –∫–æ–¥–∏—Ä–∞–Ω–∏—è —Ç–µ–∫—Å—Ç..."></textarea>
    <button onclick="decodeMessage()">–†–∞–∑–∫–æ–¥–∏—Ä–∞–π ‚¨á</button>

    <h2>üí¨ –†–∞–∑–∫–æ–¥–∏—Ä–∞–Ω–æ</h2>
    <div id="decodedBox" class="chatHistory"></div>
  </div>

</div>

<script>
/* ================== –†–ï–ß–ù–ò–ö ================== */
let baseDictionary = {
"–∑–¥—Ä–∞–≤–µ–π":"–≥–ª—É–≤–µ–∫","–∑–¥—Ä–∞—Å—Ç–∏":"–≥–ª–µ–≤—É–∫","–∫–∞–∫":"—Ç—Ä–µ","—Å–∏":"–º—É–ª—á–∞",
"–¥–æ–±—Ä–µ":"—à–ª—è–ø–∫–æ","–ø—Ä–∏—è—Ç–µ–ª":"–¥—Ä—É–∂–∫–æ","–±—Ä–∞—Ç":"–±–∞—Ç–æ–Ω","—á–æ–≤–µ–∫":"–∑–º—É—Ä",
"—Ö–æ—Ä–∞":"–º—Ä–∞–≤–∫–∏","–∂–µ–Ω–∞":"–∫–∞–∫–∞","–º—ä–∂":"–±–∞—Ç–∫–∞","–º–æ–º–∏—á–µ":"–ø–ª—é–≤–∫–∞",
"–º–æ–º—á–µ":"–∂–º—É—Ä","–¥–∞":"—Ç—Ä–æ–ª–∞","–Ω–µ":"–±—Ä—É–º","–º–æ–∂–µ":"–≤—Ä—ä—Ç",
"—Ç—Ä—è–±–≤–∞":"–¥–∂–∞—Å—Ç–∞","–∏—Å–∫–∞–º":"–º—ä–≥–ª–∞","–æ—Ç–∏–≤–∞–º":"–∑—É—Ä—Ç—è","–∏–¥–≤–∞–º":"–≤–∂–∂",
"–≤–∏–∂":"–∫—Ä–∞–º","–≤–∏–¥–∏–º":"–∫—Ä–∞–º—É–ª—è","–≥–ª–µ–¥–∞–π":"–∑–∏—Ä","—á–∞–∫–∞–π":"–º—Ä—ä–Ω",
"–±—ä—Ä–∑–æ":"–¥–∂–∏–≥","–±–∞–≤–Ω–æ":"—à–ª—è–ø","–ø—Ä–æ–±–≤–∞–º–µ":"–∑–æ—Ä—Ç–µ–∫","–ø–ª–∞–Ω":"–º—Ä—è–∫",
"–∏–¥–µ—è":"—à—É—à–ª—è–∫","—Ä–∞–±–æ—Ç–∞":"—á–æ–º–±–∞","–∑–∞–¥–∞—á–∞":"—Ç—Ä—è—Å—ä–∫","—Ç–∞–π–Ω–æ":"—à—É—à",
"—Å–∫—Ä–∏—Ç–æ":"–º—ä–ª—á","–≥–æ–≤–æ—Ä–∏–º":"–±—Ä—ä–º","–ø–∏—Å–∞—Ö":"–¥—Ä–∞—Å","–∫–∞–∑–∞—Ö":"–∂–≥—ä—Ç",
"–ø–∞—Ä–∏":"—Ä–∏–±–∏","–¥–æ–∫—É–º–µ–Ω—Ç":"—Ö–∞—Ä—Ç–∏–π","—Å—Ä–µ—â–∞":"—Å–±–∏—Ä–∫–∞","–º—è—Å—Ç–æ":"–¥—É–ø–∫–∞",
"—Ç—É–∫":"—Ç—É–∫–∞","—Ç–∞–º":"—Ç–∞–º–∫–∞","–≥–æ—Ä–µ":"–≤—Ä—ä—Ü","–¥–æ–ª—É":"–≥–ª—ä–±",
"–≤—Ö–æ–¥":"–¥—É–ø","–∏–∑—Ö–æ–¥":"–±–µ–≥","–ø—Ä–æ–±–ª–µ–º":"—Ç—É–ª–±–∞","–æ–ø–∞—Å–Ω–æ":"–∂—É–ª",
"—Å–ø–æ–∫–æ–π–Ω–æ":"–º–µ–∫–∞","—Å–∏–≥—É—Ä–Ω–æ":"–±–µ—Ç–æ–Ω","–Ω–µ—Å–∏–≥—É—Ä–Ω–æ":"—Ö–ª—ä–∑",
"—É—Ç—Ä–µ":"–≤—Ä—è–∫","–¥–Ω–µ—Å":"–¥–Ω–µ—Å–∫–∞","–≤—á–µ—Ä–∞":"–º–∏–Ω—É","–ø–æ—Å–ª–µ":"—Å–µ—Ç–Ω–µ",
"–≤–µ–¥–Ω–∞–≥–∞":"–¥–∂–∞—Å—Ç–∞","–≥–æ—Ç–æ–≤–æ":"—á—É–∫","–∫—Ä–∞–π":"—Ñ–∏–Ω—á","–Ω–∞—á–∞–ª–æ":"—Å—Ç–∞—Ä",
"–∫–Ω–∏–≥–∞":"–ª–∏—Å—Ç–∞–∫","—Ç–µ—Ñ—Ç–µ—Ä":"–¥—Ä–∞—Å–∫","–∫–ª—é—á":"–∑—ä–±","–≤—Ä–∞—Ç–∞":"–¥—É–ø–∫–∞",
"–º–∞–∑–µ":"–≥–ª—ä–±–∏–Ω–∞","—Ä–∞–π–æ–Ω":"–æ–±–ª–∞–∫","—É–ª–∏—Ü–∞":"–ø—ä—Ç–µ–∫","–∫–æ–ª–∞":"–±—Ä—ä–º–∫–∞",
"—Ç–µ–ª–µ—Ñ–æ–Ω":"–∂—É–∂–∫–∞","—Å—ä–æ–±—â–µ–Ω–∏–µ":"–º—Ä—è–≤–∫–∞","—á–∞—Ç":"–±—ä—Ä–±–æ—Ä","–∫–æ–¥":"—à—É–º",
"—Ç–∞–π–Ω–∞":"—à—É—à","–∏—Å—Ç–∏–Ω–∞":"–±–µ—Ç–æ–Ω","–ª—ä–∂–∞":"–ø—É—à–µ–∫"
};

/* ========= –®–£–ú + –°–¢–ê–ë–ò–õ–ù–ò –î–£–ú–ò ========= */
let noiseWords = ["—à–ª—è–ø","–º—Ä—è–∫","–∑–æ—Ä—Ç","–±—É–º–∫–∞","—Ç—Ä—è—Å","–ø–ª—è—Å","–≤–∂–∂","–¥—Ä—ä–Ω","–∂–∂–∂","—Ç—Ä—ä–∫","–±–ª—è–º","—à—É–ø","–≤—Ä—è—Å","–≥—Ä—É—Ö","—Ç—ä—Ü","–ø—Ä–∞—Å"];
let stableWords = ["—Ç—Ä–æ–ª–∞","–±—Ä—É–º","–¥–∂–∞—Å—Ç–∞","—à—É—à","–±–µ—Ç–æ–Ω","–º–µ–∫–∞","—á—É–∫","—Ñ–∏–Ω—á"];

/* ========= –†–ê–ó–ë–™–†–ö–í–ê–ù–ï ========= */
function shuffleWord(word){
  if(stableWords.includes(word)) return word;
  if(word.length < 4) return word;
  let arr = word.split('');
  for(let i = arr.length-2; i>1; i--){
    let j = Math.floor(Math.random()*(i-1))+1;
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr.join('');
}

/* ========= –¢–ê–ï–ù –ö–õ–Æ–ß ========= */
function applySecretKey(key){
  if(!key) return;
  let seed=0;
  for(let c of key) seed+=c.charCodeAt(0);
  let keys=Object.keys(baseDictionary);
  keys.forEach((k,i)=>{
    if((i+seed)%3===0) baseDictionary[k]=shuffleWord(baseDictionary[k]);
    if((i+seed)%5===0) baseDictionary[k]+=noiseWords[seed%noiseWords.length];
  });
}

/* ========= –ö–û–î–ò–†–ê–ù–ï ========= */
function encodeMessage(){
  let text=document.getElementById("normalInput").value.toLowerCase();
  let key=document.getElementById("secretKey").value;
  applySecretKey(key);

  let words=text.split(" ");
  let encoded=words.map(w=>{
    let clean=w.replace(/[.,!?]/g,"");
    let mapped=baseDictionary[clean]||clean;
    if(Math.random()<0.25) mapped+=noiseWords[Math.floor(Math.random()*noiseWords.length)];
    return shuffleWord(mapped);
  }).join(" ");

  document.getElementById("encodedBox").innerHTML+=encoded+"<br>";
  document.getElementById("chatBox").innerHTML+="<b>–¢–∏:</b> "+text+"<br>";
  saveHistory();
}

/* ========= –†–ê–ó–ö–û–î–ò–†–ê–ù–ï ========= */
function decodeMessage(){
  let text=document.getElementById("replyInput").value.toLowerCase();
  let reversed=Object.fromEntries(Object.entries(baseDictionary).map(([k,v])=>[v,k]));
  let words=text.split(" ");
  let decoded=words.map(w=>reversed[w]||w).join(" ");
  document.getElementById("decodedBox").innerHTML+=decoded+"<br>";
}

/* ========= –ò–°–¢–û–†–ò–Ø ========= */
function saveHistory(){
  localStorage.setItem("chatHistory",document.getElementById("chatBox").innerHTML);
}
function loadHistory(){
  let h=localStorage.getItem("chatHistory");
  if(h) document.getElementById("chatBox").innerHTML=h;
}
window.onload=loadHistory;
</script>

</body>
</html>
